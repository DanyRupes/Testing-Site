<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-app.js";
    import { onMessage, getToken, getMessaging } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-messaging.js";
    import { onBackgroundMessage } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-messaging-sw.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyCud89dpES9zKc_3Zcz9EDG8dwsI-XblTE",
      authDomain: "develop-jz.firebaseapp.com",
      projectId: "develop-jz",
      storageBucket: "develop-jz.appspot.com",
      messagingSenderId: "722040087904",
      appId: "1:722040087904:web:a791336cf7cd40e53aaa05",
      measurementId: "G-4L1KL33EX5"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging();

    //This code recieve message from server /your app and print message to console if same tab is opened as of project in browser 

    onMessage(messaging, (payload) => {
      console.log('Message received. -------------');
    });

    //Custom function made to run firebase service 
    getStartToken();

    function getStartToken() {
      getToken(messaging, { vapidKey: "BKp-ht5oTPd6op2Uvhp7MLNaIWxY9uqQrvzJM-oh4GDrnp4eyas9RzGDZO4wNBG9b9YZvR3NE2-4DINnDmju6_E" }).then((currentToken) => {
        console.log({currentToken})
        if (currentToken) {
         
        }
        else {
          RequestPermission();
        }
      }).catch((err) => {
        console.log(err)
      });
    }
    function RequestPermission() {
      messaging.requestPermission()
        .then(function (permission) {
          if (permission === 'granted') {
            console.log("have Permission");
            getStartToken();
          }
          else { console.log("Permission Denied"); }
        }).catch(function (err) {
          console.log(err);
        })
    }

  </script>

</body>

</html>